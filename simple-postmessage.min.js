/* simple postMessage - v0.1.0
 * by Leonardo Dutra (https://github.com/LeoDutra)
 * Dual licensed under the MIT and GPL licenses.
 *
 * based on
 *
 * ender postMessage - v0.1.3 - 5/1/2012
 * by Thomas Sturm http://www.sturm.to
 * Dual licensed under the MIT and GPL licenses.
 *
 * based on 
 *
 * jQuery postMessage - v0.5 - 9/11/2009
 * http://benalman.com/projects/jquery-postmessage-plugin/
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

!function(a){var e,k,f,r=0,g,l=a.postMessage,c=a.JSON,m=navigator.userAgent.toLowerCase(),n=~m.indexOf("msie")&&parseInt(m.split("msie")[1],10),p=function(b){return c?c.stringify(b):b},q=function(b){return c?c.parse(b):b};a.simplePostMessage=function(b,a,d){a&&(d=d||opener||parent,l?(10>n&&(b=p(b)),d.postMessage(b,a.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))):d.location=a.replace(/#.*$/,"")+"#"+ +new Date+ ++r+"&"+encodeURIComponent(p(b)))};a.simpleReceiveMessage=function(b,c,d){var h=typeof c;if(l)if(b&&
(g&&a.simpleReceiveMessage(),g=function(a){if("string"===h&&a.origin!==c||"function"===h&&!1===c(a.origin))return!1;10>n&&(a.data=q(a.data));b(a)}),a.addEventListener)a[b?"addEventListener":"removeEventListener"]("message",g,!1);else a[b?"attachEvent":"detachEvent"]("onmessage",g);else e&&(e=clearInterval(e)),b&&(f=document.location.hash,e=setInterval(function(){var a=document.location.hash,c=/^#?\d+&/;a!==k&&a!==f&&c.test(a)&&(k=a,document.location.hash=f?f:"",b({data:q(decodeURIComponent(a.replace(c,
"").replace(/\+/gim," ")))}))},"number"===h?c:"number"===typeof d?d:100))}}(window);
